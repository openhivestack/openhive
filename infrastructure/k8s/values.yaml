# Default values for openhive.
# This is a YAML-formatted file.
# Declare variables to be passed into your templates.

global:
  domain: "openhive.local"

image:
  repository: openhivestack/openhive
  pullPolicy: IfNotPresent
  # Overrides the image tag whose default is the chart appVersion.
  tag: "latest"

# Secrets for the application
# In production, these should be passed via --set or a secure values file
secrets:
  betterAuthSecret: "change-me-random-string-min-32-chars"
  gatewaySecret: "openhive-gateway-secret-key"
  githubClientId: ""
  githubClientSecret: ""

serviceAccount:
  # Specifies whether a service account should be created
  create: true
  # Annotations to add to the service account
  annotations: {}
  # The name of the service account to use.
  # If not set and create is true, a name is generated using the fullname template
  name: "openhive-sa"

podAnnotations: {}

service:
  type: ClusterIP
  port: 3000

ingress:
  enabled: false
  className: ""
  annotations:
    {}
    # kubernetes.io/ingress.class: nginx
    # kubernetes.io/tls-acme: "true"
  hosts:
    - host: chart-example.local
      paths:
        - path: /
          pathType: ImplementationSpecific
  tls: []
  #  - secretName: chart-example-tls
  #    hosts:
  #      - chart-example.local

resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi

# Configuration for internal providers
cloudProvider: "k8s"

# Storage Configuration
storage:
  # type: "s3" or "local"
  # If "local", OpenHive will store agent artifacts on a PersistentVolumeClaim
  type: "s3"
  local:
    path: "/var/lib/openhive/storage"
    pvc:
      enabled: true
      size: "10Gi"
      # storageClassName: "standard"

# Dependencies configuration
postgresql:
  enabled: true
  host: "postgresql"
  port: 5432
  # Using chart defaults for image registry/repository/tag to ensure stability
  # image:
  #   registry: docker.io
  #   repository: bitnami/postgresql
  #   tag: "latest"
  auth:
    database: openhive
    username: openhive
    password: "change-me-in-prod"

minio:
  enabled: true
  endpoint: "http://minio:9000"
  publicEndpoint: "http://localhost:9000"
  # Using chart defaults for image registry/repository/tag to ensure stability
  # image:
  #   registry: docker.io
  #   repository: minio/minio
  #   tag: "latest"
  auth:
    rootUser: minioadmin
    rootPassword: minioadmin
  persistence:
    enabled: true
    size: 10Gi
  defaultBuckets: "openhive-agents"

# We aliased the 'distribution' chart to 'docker-registry' in Chart.yaml,
# so we configure it here using the alias name 'registry'.
registry:
  enabled: true
  persistence:
    enabled: true
    size: 20Gi
  service:
    type: NodePort # Easier for Minikube access
    nodePort: 30500
